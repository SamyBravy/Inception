

# Inception - Docker Infrastructure

This project aims to broaden system administration and virtualization knowledge using **Docker**. The objective is to set up a complete infrastructure composed of several services running in separate containers, orchestrated by **docker-compose**.

The project adheres to the strict rules of the 42 School subject: no `--link`, no `latest` tags, usage of custom Dockerfiles, and implementation of persistent volumes.

## Architecture

The infrastructure consists of the following containers:

| Service | Base OS | Description |
| :--- | :--- | :--- |
| **NGINX** | Alpine | Web server, single entry point (Port 443), SSL/TLS (v1.2/1.3) management. |
| **MariaDB** | Alpine | SQL database for WordPress. |
| **WordPress** | Debian | CMS running with PHP-FPM (Port 9000). |
| **Redis** | Debian | (Bonus) Cache to optimize WordPress performance. |
| **FTP** | Debian | (Bonus) FTP server to access website files. |
| **Adminer** | Debian | (Bonus) Web interface for database management. |
| **Netdata** | Debian | (Bonus) Real-time system performance monitoring tool. |
| **Static Website** | Debian | (Bonus) Static website (Resume/CV) served via Node.js/Serve. |

### Network
All containers communicate via a dedicated Docker network named `inception`. Only NGINX is directly exposed on port 443. Bonus services are accessible through proxy rules in NGINX or specific ports for administration (FTP).

## ðŸ“‹ Prerequisites

*   Docker Engine
*   Docker Compose
*   Make
*   **Host Configuration**: To access the site via the required domain name, you must add the following line to your `/etc/hosts` file (replace `sdell-er` with your login if necessary):
    ```bash
    127.0.0.1 sdell-er.42.fr
    ```

## Configuration (.env)

Create a `.env` file in the `srcs/` directory with the following variables:

```env
DOMAIN_NAME=sdell-er.42.fr

# MySQL Setup
DB_NAME=wordpress
DB_ROOT=rootpass
DB_USER=wpuser
DB_PASS=wppass
DB_HOST=mariadb

# WordPress Admin
WP_ADMIN_USER=admin
WP_ADMIN_PASS=adminpass
WP_ADMIN_EMAIL=admin@student.42.fr

# WordPress User
WP_USER=author
WP_USER_PASS=authorpass
WP_USER_EMAIL=author@student.42.fr

# FTP
FTP_USER=ftpuser
FTP_PASS=ftppass
```

## Installation & Usage

A `Makefile` is provided to automate common tasks.

### Start the project
Builds images, creates volume directories, and starts containers in the background:
```bash
make all
```

### Stop the project
Stops and removes containers:
```bash
make down
```

### Clean (Reset)
Stops containers, removes images, networks, and Docker volumes (but keeps data on the host):
```bash
make clean
```

### Full Clean (Hard Reset)
**Warning**: Deletes everything, including persistent data (database and WordPress files) stored in `/home/${USER}/data`:
```bash
make fclean
```

## Accessing Services

Once the infrastructure is up, you can access the services via your browser or tools:

*   **WordPress (Main Site)**: `https://sdell-er.42.fr`
*   **Adminer (DB Manager)**: `https://sdell-er.42.fr/adminer`
*   **Static Site**: `https://sdell-er.42.fr/static/`
*   **Netdata (Monitoring)**: `https://sdell-er.42.fr/netdata/`
*   **FTP**:
    *   Host: `localhost`
    *   Port: `21`
    *   User/Pass: Defined in `.env`

## Directory Structure

```
Inception/
â”œâ”€â”€ Makefile
â”œâ”€â”€ srcs/
â”‚   â”œâ”€â”€ docker-compose.yml
â”‚   â”œâ”€â”€ .env
â”‚   â””â”€â”€ requirements/
â”‚       â”œâ”€â”€ mariadb/       # Dockerfile & DB scripts
â”‚       â”œâ”€â”€ nginx/         # Dockerfile & SSL/HTTP conf
â”‚       â”œâ”€â”€ wordpress/     # Dockerfile & PHP-FPM conf
â”‚       â”œâ”€â”€ bonus/
â”‚       â”‚   â”œâ”€â”€ adminer/   # Web DB Management
â”‚       â”‚   â”œâ”€â”€ ftp/       # vsftpd Server
â”‚       â”‚   â”œâ”€â”€ netdata/   # Real-time monitoring
â”‚       â”‚   â”œâ”€â”€ redis/     # Object Cache
â”‚       â”‚   â””â”€â”€ static/    # Personal CV Website
â”‚       â””â”€â”€ tools/         # Utility scripts (make_dir.sh)
â””â”€â”€ ...
```

## Security & Data

*   **SSL Certificates**: Automatically generated by the NGINX Dockerfile for the domain `sdell-er.42.fr`.
*   **Persistence**: Database data and WordPress files are stored on the host machine in `/home/${USER}/data/`.
